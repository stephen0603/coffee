"use strict";(self["webpackChunknew_project"]=self["webpackChunknew_project"]||[]).push([[556],{9556:function(t,s,e){e.r(s),e.d(s,{default:function(){return M}});var o=e(3396),i=e(7139),a=e(9242);const n={class:"container"},l={class:"row mt-5 justify-content-center"},c=(0,o.uE)('<div class="col-lg-8 step-navigation"><div class="email text-success"><i class="bi bi-envelope-fill" aria-hidden="true"></i><h5>確認商品</h5></div><div class="name text-secondary"><i class="bi bi-person-fill" aria-hidden="true"></i><h5>填寫資料</h5></div><div class="password text-secondary"><i class="bi bi-unlock-fill" aria-hidden="true"></i><h5>付款</h5></div></div>',1),d={class:"mt-5"},u={class:"sticky-top"},r={class:"table align-middle"},p=(0,o._)("thead",null,[(0,o._)("tr",null,[(0,o._)("th"),(0,o._)("th",null,"品名"),(0,o._)("th",{style:{width:"110px"}},"數量"),(0,o._)("th",null,"單價")])],-1),h=["disabled","onClick"],g=(0,o._)("i",{class:"bi bi-x"},null,-1),_=[g],m={key:0,class:"text-success"},v={class:"input-group input-group-sm"},b=["disabled","onChange","onUpdate:modelValue"],y={class:"input-group-text"},C={class:"text-end"},x={key:0,class:"text-success"},f=(0,o._)("td",{colspan:"3",class:"text-end"},"總計",-1),k={class:"text-end"},w={key:0},$=(0,o._)("td",{colspan:"3",class:"text-end text-success"},"折扣價",-1),I={class:"text-end text-success"},L={class:"input-group mb-3 input-group-sm"},q={class:"input-group-append"},D=(0,o._)("div",null,null,-1);function z(t,s,e,g,z,U){const j=(0,o.up)("Loading");return(0,o.wg)(),(0,o.iD)(o.HY,null,[(0,o.Wm)(j,{active:t.isLoading},null,8,["active"]),(0,o._)("div",n,[(0,o._)("div",l,[c,(0,o._)("div",d,[(0,o._)("div",u,[(0,o._)("table",r,[p,(0,o._)("tbody",null,[z.cart.carts?((0,o.wg)(!0),(0,o.iD)(o.HY,{key:0},(0,o.Ko)(z.cart.carts,(s=>((0,o.wg)(),(0,o.iD)("tr",{key:s.id},[(0,o._)("td",null,[(0,o._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:z.status.loadingItem===s.id,onClick:t=>U.removeCartItem(s.id)},_,8,h)]),(0,o._)("td",null,[(0,o.Uk)((0,i.zw)(s.product.title)+" ",1),s.coupon?((0,o.wg)(),(0,o.iD)("div",m," 已套用優惠券 ")):(0,o.kq)("",!0)]),(0,o._)("td",null,[(0,o._)("div",v,[(0,o.wy)((0,o._)("input",{type:"number",class:"form-control",min:"1",disabled:s.id===z.status.loadingItem,onChange:t=>U.updateCart(s),"onUpdate:modelValue":t=>s.qty=t},null,40,b),[[a.nr,s.qty,void 0,{number:!0}]]),(0,o._)("div",y,"/ "+(0,i.zw)(s.product.unit),1)])]),(0,o._)("td",C,[z.cart.final_total!==z.cart.total?((0,o.wg)(),(0,o.iD)("small",x,"折扣價：")):(0,o.kq)("",!0),(0,o.Uk)(" "+(0,i.zw)(t.$filters.currency(s.final_total)),1)])])))),128)):(0,o.kq)("",!0)]),(0,o._)("tfoot",null,[(0,o._)("tr",null,[f,(0,o._)("td",k,(0,i.zw)(t.$filters.currency(z.cart.total)),1)]),z.cart.final_total!==z.cart.total?((0,o.wg)(),(0,o.iD)("tr",w,[$,(0,o._)("td",I,(0,i.zw)(t.$filters.currency(z.cart.total)),1)])):(0,o.kq)("",!0)])]),(0,o._)("div",L,[(0,o.wy)((0,o._)("input",{type:"text",class:"form-control","onUpdate:modelValue":s[0]||(s[0]=t=>z.coupon_code=t),placeholder:"請輸入優惠碼"},null,512),[[a.nr,z.coupon_code]]),(0,o._)("div",q,[(0,o._)("button",{class:"btn btn-outline-secondary",type:"button",onClick:s[1]||(s[1]=(...t)=>U.addCouponCode&&U.addCouponCode(...t))}," 套用優惠碼 ")]),(0,o._)("button",{type:"button",class:(0,i.C_)(["form-control btn btn-outline-danger ms-3 rounded",{disabled:0===z.cart.total}]),onClick:s[2]||(s[2]=(0,a.iM)(((...t)=>U.goForm&&U.goForm(...t)),["prevent"]))},"確認商品",2)]),D])])])])],64)}e(7658);var U={data(){return{products:[],product:{},status:{loadingItem:""},cart:{},coupon_code:""}},methods:{getProducts(){const t="https://vue3-course-api.hexschool.io/api/stephen-api/products/all";this.isLoading=!0,this.$http.get(t).then((t=>{this.products=t.data.products,console.log("products:",t),this.isLoading=!1}))},getProduct(t){this.$router.push(`/user/product/${t}`)},addCart(t){const s="https://vue3-course-api.hexschool.io/api/stephen-api/cart";this.status.loadingItem=t;const e={product_id:t,qty:1};this.$http.post(s,{data:e}).then((t=>{this.status.loadingItem="",console.log(t),this.getCart()}))},getCart(){const t="https://vue3-course-api.hexschool.io/api/stephen-api/cart";this.isLoading=!0,this.$http.get(t).then((t=>{console.log(t),this.cart=t.data.data,this.isLoading=!1}))},updateCart(t){const s=`https://vue3-course-api.hexschool.io/api/stephen-api/cart/${t.id}`;this.isLoading=!0,this.status.loadingItem=t.id;const e={product_id:t.product_id,qty:t.qty};this.$http.put(s,{data:e}).then((t=>{console.log(t),this.status.loadingItem="",this.getCart()}))},removeCartItem(t){this.status.loadingItem=t;const s=`https://vue3-course-api.hexschool.io/api/stephen-api/cart/${t}`;this.isLoading=!0,this.$http.delete(s).then((t=>{this.$httpMessageState(t,"移除購物車品項"),this.status.loadingItem="",this.getCart(),this.isLoading=!1}))},addCouponCode(){const t="https://vue3-course-api.hexschool.io/api/stephen-api/coupon",s={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:s}).then((t=>{this.$httpMessageState(t,"加入優惠券"),this.getCart(),this.isLoading=!1}))},goForm(){this.$router.push("/user/form")}},created(){this.getProducts(),this.getCart()}},j=e(89);const F=(0,j.Z)(U,[["render",z]]);var M=F}}]);
//# sourceMappingURL=556.3b92c710.js.map